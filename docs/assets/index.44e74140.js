import{E as Q,a as j,d as U,r as p,w as W,b as X,c as ee,e as te,f as oe,g as se,o as _,h as C,i as v,j as d,k as m,l as L,v as T,u as E,m as ne,n as ae,p as le,F as P,q as ue,s as O,t as $,x as re,y as ie,z as G,A as ce,B as de,C as pe,D as ve,G as ge}from"./vendor.e69e533c.js";const fe=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&g(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}};fe();const Ee=20,H=[10,20,30,40,50],M="1.1.1";function h(e,s){window.localStorage.setItem(e,JSON.stringify(s))}function S(e){const s=window.localStorage.getItem(e);return s&&JSON.parse(s)}function _e(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const b=Boolean(window.electron),Y=async()=>{if(!b)return;const e=(await window.electron.apis.getAppVersion()).data;console.log("ELECTRON_VERSION",e),M!==e&&Q({title:`\u6709\u65B0\u7684\u7248\u672C(${M})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};Y();const B=e=>{j({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},D=async(e,...s)=>b?window.electron.apis[e]?(console.log(`request: ${e}`,s),window.electron.apis[e](...s).then(n=>(console.log("response:",n),n.success||(B(n.message),console.error(n.message)),n)).catch(n=>(B("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(n),{success:!1}))):(B(`Electron \u63A5\u53E3[${e}]\u4E0D\u5B58\u5728\uFF0C\u8BF7\u786E\u8BA4\u7248\u672C`),Y(),{success:!1}):(B("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1}),me=(...e)=>D("openFileOrFolder",...e),Fe=(...e)=>D("getProjectsByPage",...e),ye=(...e)=>D("scanProjectsToDb",...e),Ce=(...e)=>D("selectFolder",...e),we=async e=>b?window.electron.getImg(e):"";var Ae=(e,s)=>{for(const[n,g]of s)e[n]=g;return e};const Pe=e=>(ce("data-v-47903d18"),e=e(),de(),e),he={class:"folder-line"},Se=O("\u9009\u62E9\u6587\u4EF6\u5939"),Be=O(" \u91CD\u65B0\u540C\u6B65 "),De=Pe(()=>v("span",{class:"order-explain"},"\u6839\u636E",-1)),ke={class:"pagination-line"},xe={class:"pic-box"},Ie=["src","onClick","onContextmenu"],Le=["title"],Te={class:"pagination-line"},Oe=U({setup(e){const s=p(!1),n=p(S("SELECTED_PATH")||""),g=p([]),l=p(0),o=p(1),c=p(S("PAGE_SIZE")||Ee),k=p([]),w=p(S("ORDER_BY")||"create_time"),F=p(S("ORDER_TYPE")||"DESC"),z=(a,t)=>`${n.value}/${a}/${t}`,Z=async a=>{for(const[t,{project_folder:u,preview:r}]of a.entries()){const y=await we(z(u,r));k.value.splice(t,1,y)}},x=async(a,t)=>{if(!n.value)return;window.scrollTo(0,0);const u=await Fe(n.value,w.value,F.value,a,t);if(u.success&&u.data){const r=u.data.list;g.value=r,l.value=u.data.total,k.value=new Array(r.length).fill(void 0),Z(r)}},R=async a=>{s.value=!0;const t=new Promise(r=>setTimeout(r,500)),u=await ye(a);t.then(()=>{if(s.value=!1,u.success&&u.data){const r=`\u6210\u529F\u540C\u6B65 ${u.data.length} \uFF0C\u65B0\u589E ${u.data.newCount} \uFF0C\u6E05\u9664 ${u.data.invalidCount} \u3002`;j({showClose:!0,message:r,type:"success",duration:3e3}),console.log(r),o.value===1&&x(1,c.value),o.value=1}})},q=async()=>{s.value=!0;const a=await Ce();a.success&&a.data?(n.value=a.data,h("SELECTED_PATH",a.data),R(a.data)):s.value=!1},J=()=>{F.value=F.value==="ASC"?"DESC":"ASC"},N=({project_folder:a,file:t},u)=>{me(z(a,t),u)};return document.addEventListener("keydown",a=>{["ArrowLeft","KeyA"].includes(a.code)?o.value>1&&(o.value-=1):["ArrowRight","KeyD"].includes(a.code)&&o.value<Math.ceil(l.value/c.value)&&(o.value+=1)}),W([o,c,w,F],([a,t,u,r],[,y,A,I])=>{let f=!1;if(t!==y&&(h("PAGE_SIZE",t),f=!0),u!==A&&(h("ORDER_BY",u),f=!0),r!==I&&(h("ORDER_TYPE",r),f=!0),f&&a!==1){o.value=1;return}x(a,t)}),x(o.value,c.value),(a,t)=>{const u=pe,r=X,y=ee,A=te,I=oe,f=se;return _(),C(P,null,[v("div",he,[d(y,{placement:"bottom",content:n.value,disabled:!n.value},{default:m(()=>[d(r,{onClick:q,loading:s.value},{default:m(()=>[L(d(u,{style:{"margin-right":"6px"}},{default:m(()=>[L(d(E(ne),null,null,512),[[T,!n.value]]),L(d(E(ae),{color:"#67C23A"},null,512),[[T,n.value]])]),_:1},512),[[T,!s.value]]),le(a.$slots,"default",{},()=>[Se],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),n.value?(_(),C(P,{key:0},[d(r,{onClick:t[0]||(t[0]=()=>R(n.value)),icon:E(ue),loading:s.value},{default:m(()=>[Be]),_:1},8,["icon","loading"]),De,d(I,{modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=i=>w.value=i),loading:s.value,style:{"margin-left":"12px",width:"120px"}},{default:m(()=>[d(A,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),d(A,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),d(r,{onClick:J,icon:E(re),loading:s.value,style:{"margin-left":"12px"}},{default:m(()=>[O($(F.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"])],64)):ie("",!0)]),v("div",ke,[d(f,{currentPage:o.value,"onUpdate:currentPage":t[2]||(t[2]=i=>o.value=i),"page-size":c.value,"onUpdate:page-size":t[3]||(t[3]=i=>c.value=i),"page-sizes":E(H),total:l.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),v("div",xe,[(_(!0),C(P,null,G(g.value,(i,V)=>(_(),C("div",{key:V,class:"pic-item"},[v("img",{class:"img",alt:"",src:k.value[V],onClick:K=>N(i),onContextmenu:K=>N(i,!0)},null,40,Ie),v("p",{title:i.title}," ["+$(E(_e)(i.file_size))+"]\xA0"+$(i.title),9,Le)]))),128)),(_(),C(P,null,G(10,i=>v("div",{key:i,class:"pic-item",style:{"margin-top":"0"}})),64))]),v("div",Te,[d(f,{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=i=>o.value=i),"page-size":c.value,"onUpdate:page-size":t[5]||(t[5]=i=>c.value=i),"page-sizes":E(H),total:l.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var $e=Ae(Oe,[["__scopeId","data-v-47903d18"]]);const be=U({setup(e){return(s,n)=>(_(),ve($e))}});console.log("APP_VERSION","1.1.2");ge(be).mount("#app");

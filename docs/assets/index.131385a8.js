import{d as C,r as d,w as U,E as V,o as f,c as y,a as c,b as _,e as I,u as v,f as z,t as L,g as k,v as Z,h as G,i as x,F as E,j as b,p as H,k as M,l as B,n as q,m as P,q as J,s as R}from"./vendor.07899d5c.js";const K=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&p(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function p(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}};K();const Y=20,D=[10,20,30,40,50];function N(r,n){window.localStorage.setItem(r,JSON.stringify(n))}function h(r){const n=window.localStorage.getItem(r);return n&&JSON.parse(n)}var Q=(r,n)=>{for(const[i,p]of n)r[i]=p;return r};const W=r=>(H("data-v-811a616a"),r=r(),M(),r),X={class:"folder-line"},ee=P("\u9009\u62E9\u6587\u4EF6\u5939"),te={class:"folder-path"},se=P("\xA0\xA0"),oe=[se],ae=P("\u91CD\u65B0\u540C\u6B65"),ne=W(()=>c("span",null,"\xA0\xA0",-1)),le={class:"pagination-line"},re={class:"pic-box"},ie=["src","onClick"],ue=["title"],ce={class:"pagination-line"},de=C({setup(r){console.log(window.electron);const n=d(!1),i=d(h("SELECTED_PATH")||""),p=d([]),a=d(0),o=d(1),u=d(h("PAGE_SIZE")||Y),m=d([]),F=d(h("DYNAMIC_PAGE_SIZE")||!1),S=(e,t)=>`${i.value+e}/${t}`,T=e=>window.electron.getImg(S(e.project_folder,e.preview)),j=async e=>{for(const[t,l]of e.entries()){const s=await T(l);m.value.splice(t,1,s)}},$=e=>{window.electron.apis.openFile(S(e.project_folder,e.file))},w=async(e,t,l)=>{!e||window.electron.apis.getProjectsByPage(e,t,l).then(s=>{console.log("getProjects res",s);const g=s.data.list;p.value=g,a.value=s.data.total,m.value=new Array(g.length).fill(void 0),j(g)})},A=async e=>{n.value=!0;const t=new Promise(s=>setTimeout(s,500)),l=await window.electron.apis.scanProjectsToDb(e);t.then(()=>{n.value=!1,console.log("scanRes",l),l.success?(B({message:`\u6210\u529F\u540C\u6B65 ${l.data.length} \uFF0C\u65B0\u589E ${l.data.newCount} \uFF0C\u6E05\u9664 ${l.data.invalidCount} \u3002`,type:"success",duration:1500}),o.value===1&&w(i.value,1,u.value),o.value=1):(console.log(l.msg),B({message:`\u53D1\u751F\u4E86\u9519\u8BEF\uFF1A ${l.msg}`,type:"error",duration:1800}))})},O=async()=>{const e=await window.electron.apis.selectFolder();e.success&&e.data&&(i.value=e.data,N("SELECTED_PATH",e.data),A(e.data))};return U([o,u],([e,t],[,l])=>{if(t!==l&&(N("PAGE_SIZE",t),e!==1)){o.value=1;return}w(i.value,e,t)}),w(i.value,o.value,u.value),(e,t)=>{const l=V;return f(),y(E,null,[c("div",X,[_(v(z),{size:"small",onClick:O},{default:I(()=>[ee]),_:1}),c("div",te,[c("span",null,L(i.value),1),k(c("span",null,oe,512),[[l,n.value]])]),k(_(v(z),{size:"small",onClick:t[0]||(t[0]=()=>A(i.value))},{default:I(()=>[ae]),_:1},512),[[Z,i.value]]),ne,_(v(G),{size:"small",modelValue:F.value,"onUpdate:modelValue":t[1]||(t[1]=s=>F.value=s),label:"\u52A8\u6001\u6761\u6570",border:""},null,8,["modelValue"])]),c("div",le,[_(v(x),{currentPage:o.value,"onUpdate:currentPage":t[2]||(t[2]=s=>o.value=s),"page-size":u.value,"onUpdate:page-size":t[3]||(t[3]=s=>u.value=s),"page-sizes":v(D),total:a.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),c("div",re,[(f(!0),y(E,null,b(p.value,(s,g)=>(f(),y("div",{key:g,class:"pic-item"},[c("img",{class:"img",src:m.value[g],alt:"",style:q({opacity:m.value[g]?1:0}),onClick:ve=>$(s),onerror:"this.classList.add('error');"},null,12,ie),c("p",{title:s.title},L(s.title),9,ue)]))),128)),(f(),y(E,null,b(20,s=>c("div",{key:s,class:"pic-item",style:{"margin-top":"0"}})),64))]),c("div",ce,[_(v(x),{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=s=>o.value=s),"page-size":u.value,"onUpdate:page-size":t[5]||(t[5]=s=>u.value=s),"page-sizes":v(D),total:a.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var pe=Q(de,[["__scopeId","data-v-811a616a"]]);const ge=C({setup(r){return(n,i)=>(f(),J(pe))}});R(ge).mount("#app");

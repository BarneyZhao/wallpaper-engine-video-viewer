var Pe=Object.defineProperty,he=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var J=(e,t,a)=>t in e?Pe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,K=(e,t)=>{for(var a in t||(t={}))Ie.call(t,a)&&J(e,a,t[a]);if(j)for(var a of j(t))Se.call(t,a)&&J(e,a,t[a]);return e},Q=(e,t)=>he(e,Ae(t));import{s as De,E as we,a as X,d as ee,r as v,w as G,b as Te,c as Be,e as Ne,f as ke,g as Oe,h as be,i as xe,j as Re,k as $e,l as Le,o as I,m as T,n as y,p as r,q as m,F as b,u as g,t as Ve,v as te,x as oe,y as ae,z as ze,A as Ue,B as H,C as Y,D as Ge,G as He,H as Ye,I as Me,J as M,K as q,L as qe,M as We}from"./vendor.036afa09.js";const Ze=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const _ of i.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&d(_)}).observe(document,{childList:!0,subtree:!0});function a(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(l){if(l.ep)return;l.ep=!0;const i=a(l);fetch(l.href,i)}};Ze();const je=20,se=[10,20,30,40,50],ne="1.5.0";function S(e,t){window.localStorage.setItem(e,JSON.stringify(t))}function D(e){const t=window.localStorage.getItem(e);return t&&JSON.parse(t)}function Je(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const le="SELECTED_PATH",Ke="SELECTED_COPY_PATH",ue="SYNC_INFO",ce="PAGE_SIZE",ie="ORDER_BY",re="ORDER_TYPE",de="CHECK_REPEAT",Qe=["getAppVersion","showContextmenus","selectFolder","openFile","copyFolderToPath","openDbFileFolder","scanProjectsToDb","getProjectsByPage","checkEverything"];var C;(function(e){e[e.NORMAL=0]="NORMAL",e[e.RUNING=1]="RUNING",e[e.COPIED=2]="COPIED"})(C||(C={}));const x=window.electron,W=Boolean(x),pe=async()=>{if(!W)return;const e=(await x.apis.getAppVersion()).data;console.log("ELECTRON_VERSION:",e),e&&De.gt(ne,e)&&we({title:`\u6709\u65B0\u7684\u7248\u672C(${ne})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};pe();const R=e=>{X({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},Xe=async(e,...t)=>{if(!W)return R("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1};const a=x.apis;return a[e]?(console.log(`request: ${e}`,t),a[e](...t).then(d=>(console.log("response:",d),d.success||(R(d.message),console.error(d.message)),d)).catch(d=>(R("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(d),{success:!1}))):(R(`Electron \u63A5\u53E3[${e}]\u4E0D\u5B58\u5728\uFF0C\u8BF7\u786E\u8BA4\u7248\u672C`),pe(),{success:!1})},F=Qe.reduce((e,t)=>Q(K({},e),{[t]:(...a)=>Xe(t,...a)}),{}),et=async e=>W?x.getImg(e):"";var tt=(e,t)=>{for(const[a,d]of t)e[a]=d;return e};const ot=e=>(ze("data-v-8f1afaf4"),e=e(),Ue(),e),at={class:"folder-line"},st=M("\u9009\u62E9\u6587\u4EF6\u5939"),nt=M(" \u91CD\u65B0\u540C\u6B65 "),lt=ot(()=>y("span",{class:"order-explain"},"\u6839\u636E",-1)),ut={class:"pagination-line"},ct={class:"pic-box"},it=["src","onClick","onContextmenu"],rt=["title"],dt={class:"pagination-line"},pt=ee({setup(e){const t=v(!1),a=v(D(le)||""),d=v(D(Ke)||""),l=v(D(ue)||{syncWhenInit:!1,timestamp:""}),i=v([]),_=v(0),p=v(1),P=v(D(ce)||je),$=v([]),B=v(D(ie)||"create_time"),w=v(D(re)||"DESC"),L=v(""),V=v(""),N=v(D(de)||!1),k=(s,o)=>`${a.value}/${s}${o?`/${o}`:""}`,ve=async s=>{for(const[o,{project_folder:u,preview:c}]of s.entries()){const E=await et(k(u,c));$.value.splice(o,1,E)}},O=async s=>{if(!a.value)return;window.scrollTo(0,0);const o=await F.getProjectsByPage({folderPath:a.value,orderBy:B.value,orderType:w.value,pageNo:s,pageSize:P.value,title:V.value,checkRepeat:N.value});if(o.success&&o.data){const u=o.data.list;i.value=u,_.value=o.data.total,$.value=new Array(u.length).fill(void 0),ve(u)}},z=async s=>{t.value=!0;const o=new Promise(c=>setTimeout(c,500)),u=await F.scanProjectsToDb(s);o.then(()=>{if(t.value=!1,u.success&&u.data){l.value.timestamp=u.data.timestamp;const c=`\u6210\u529F\u540C\u6B65 ${u.data.length} \uFF0C\u65B0\u589E ${u.data.newCount} \uFF0C\u6E05\u9664 ${u.data.invalidCount} \u3002`;X({showClose:!0,message:c,type:"success",duration:3e3}),console.log(c),p.value===1&&O(1),p.value=1}})},Ee=async()=>{t.value=!0;const s=await F.selectFolder();s.success&&s.data?(a.value=s.data,S(le,s.data),z(s.data)):t.value=!1},fe=()=>{w.value=w.value==="ASC"?"DESC":"ASC"},ge=({project_folder:s,file:o})=>{F.openFile(k(s,o))},me=async({project_folder:s,file:o},u)=>{var h,A;const c=await F.showContextmenus(k(s,o),d.value).catch(console.error);if(!(c==null?void 0:c.success))return;const E=k(s);if(((h=c.data)==null?void 0:h.act)==="copySelect"){const f=await F.selectFolder();f.success&&f.data&&(console.log(`copy folder [${E}] to [${f.data}]...`),i.value[u].copyStuts=C.RUNING,await F.copyFolderToPath(E,s,f.data),d.value=f.data,S("SELECTED_COPY_PATH",f.data),i.value[u].copyStuts=C.COPIED)}((A=c.data)==null?void 0:A.act)==="copyToPrev"&&(console.log(`copy folder [${E}] to [${d.value}]...`),i.value[u].copyStuts=C.RUNING,await F.copyFolderToPath(E,s,d.value),i.value[u].copyStuts=C.COPIED)};return document.addEventListener("keydown",s=>{["ArrowLeft"].includes(s.code)?p.value>1&&(p.value-=1):["ArrowRight"].includes(s.code)&&p.value<Math.ceil(_.value/P.value)&&(p.value+=1)}),G([P,B,w,N,V],([s,o,u,c],[E,h,A,f])=>{if(s!==E&&S(ce,s),o!==h&&S(ie,o),u!==A&&S(re,u),c!==f&&S(de,c),p.value!==1){p.value=1;return}O(p.value)}),G([p],([s])=>{O(s)}),G([l],([s])=>{S(ue,s)},{deep:!0}),a.value&&l.value.syncWhenInit?z(a.value):O(p.value),(s,o)=>{const u=Te,c=Be,E=Ne,h=ke,A=Oe,f=be,_e=xe,Z=Re,ye=$e,Ce=Le;return I(),T(b,null,[y("div",at,[r(E,{placement:"bottom",content:a.value,disabled:!a.value},{default:m(()=>[r(c,{onClick:Ee,loading:t.value},{default:m(()=>[H(r(u,{style:{"margin-right":"6px"}},{default:m(()=>[H(r(g(Ge),null,null,512),[[Y,!a.value]]),H(r(g(He),{color:"#67C23A"},null,512),[[Y,a.value]])]),_:1},512),[[Y,!t.value]]),Ye(s.$slots,"default",{},()=>[st],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),a.value?(I(),T(b,{key:0},[r(E,{placement:"bottom",content:`\u4E0A\u6B21\u540C\u6B65: ${l.value.timestamp}`,disabled:!l.value.timestamp},{default:m(()=>[r(c,{onClick:o[0]||(o[0]=()=>z(a.value)),icon:g(Me),loading:t.value},{default:m(()=>[nt]),_:1},8,["icon","loading"])]),_:1},8,["content","disabled"]),r(h,{modelValue:l.value.syncWhenInit,"onUpdate:modelValue":o[1]||(o[1]=n=>l.value.syncWhenInit=n),label:"\u542F\u52A8\u65F6\u81EA\u52A8\u540C\u6B65",style:{margin:"0 0 0 12px"}},null,8,["modelValue"]),lt,r(f,{modelValue:B.value,"onUpdate:modelValue":o[2]||(o[2]=n=>B.value=n),loading:t.value,style:{"margin-left":"12px",width:"120px"}},{default:m(()=>[r(A,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),r(A,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),r(c,{onClick:fe,icon:g(Ve),loading:t.value,style:{"margin-left":"12px"}},{default:m(()=>[M(q(w.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"]),r(_e,{modelValue:L.value,"onUpdate:modelValue":o[4]||(o[4]=n=>L.value=n),placeholder:"\u8F93\u5165\u540D\u79F0\u641C\u7D22",style:{"margin-left":"12px",width:"200px"}},{append:m(()=>[r(c,{icon:g(qe),onClick:o[3]||(o[3]=n=>V.value=L.value)},null,8,["icon"])]),_:1},8,["modelValue"]),r(h,{modelValue:N.value,"onUpdate:modelValue":o[5]||(o[5]=n=>N.value=n),label:"\u67E5\u91CD\u6A21\u5F0F",border:"",style:{"margin-left":"12px"}},null,8,["modelValue"])],64)):te("",!0)]),y("div",ut,[r(Z,{currentPage:p.value,"onUpdate:currentPage":o[6]||(o[6]=n=>p.value=n),"page-size":P.value,"onUpdate:page-size":o[7]||(o[7]=n=>P.value=n),"page-sizes":g(se),total:_.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])]),i.value.length===0?(I(),oe(ye,{key:0,description:"\u4EC0\u4E48\u90FD\u6CA1\u6709~"})):te("",!0),y("div",ct,[(I(!0),T(b,null,ae(i.value,(n,U)=>(I(),T("div",{key:U,class:"pic-item"},[r(Ce,{hidden:!n.copyStuts,value:n.copyStuts===g(C).RUNING?"\u590D\u5236\u4E2D":"\u5DF2\u590D\u5236",type:n.copyStuts===g(C).RUNING?"primary":"success"},{default:m(()=>[y("img",{class:"img",alt:"",src:$.value[U],onClick:Fe=>ge(n),onContextmenu:Fe=>me(n,U)},null,40,it)]),_:2},1032,["hidden","value","type"]),y("p",{title:n.title}," ["+q(g(Je)(n.file_size))+"]\xA0"+q(n.title),9,rt)]))),128)),(I(),T(b,null,ae(10,n=>y("div",{key:n,class:"pic-item",style:{"margin-top":"0"}})),64))]),y("div",dt,[r(Z,{currentPage:p.value,"onUpdate:currentPage":o[8]||(o[8]=n=>p.value=n),"page-size":P.value,"onUpdate:page-size":o[9]||(o[9]=n=>P.value=n),"page-sizes":g(se),total:_.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var vt=tt(pt,[["__scopeId","data-v-8f1afaf4"]]);const Et=ee({setup(e){return(t,a)=>(I(),oe(vt))}});console.log("APP_VERSION:","20221130a");We(Et).mount("#app");

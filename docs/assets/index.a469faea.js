import{s as se,E as ae,a as U,d as H,r as p,w as G,b as le,c as ue,e as re,f as ie,g as ce,h as de,i as pe,j as ve,o as E,k as y,l as g,m as i,n as _,F as P,u as f,p as ge,q as fe,t as M,v as q,x as Y,y as Ee,z as _e,A as T,B as b,C as me,D as Fe,G as ye,H as L,I as $,J as Ce,K as we}from"./vendor.228c22ab.js";const Ae=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))v(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&v(d)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function v(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}};Ae();const Pe=20,Z=[10,20,30,40,50],J="1.1.2";function h(e,s){window.localStorage.setItem(e,JSON.stringify(s))}function S(e){const s=window.localStorage.getItem(e);return s&&JSON.parse(s)}function he(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const O=Boolean(window.electron),K=async()=>{if(!O)return;const e=(await window.electron.apis.getAppVersion()).data;console.log("ELECTRON_VERSION",e),se.gt(J,e)&&ae({title:`\u6709\u65B0\u7684\u7248\u672C(${J})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};K();const B=e=>{U({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},D=async(e,...s)=>O?window.electron.apis[e]?(console.log(`request: ${e}`,s),window.electron.apis[e](...s).then(a=>(console.log("response:",a),a.success||(B(a.message),console.error(a.message)),a)).catch(a=>(B("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(a),{success:!1}))):(B(`Electron \u63A5\u53E3[${e}]\u4E0D\u5B58\u5728\uFF0C\u8BF7\u786E\u8BA4\u7248\u672C`),K(),{success:!1}):(B("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1}),Se=(...e)=>D("openFileOrFolder",...e),Be=(...e)=>D("getProjectsByPage",...e),De=(...e)=>D("scanProjectsToDb",...e),Ie=(...e)=>D("selectFolder",...e),ke=async e=>O?window.electron.getImg(e):"";var xe=(e,s)=>{for(const[a,v]of s)e[a]=v;return e};const Te=e=>(Ee("data-v-0dedbc68"),e=e(),_e(),e),be={class:"folder-line"},Le=L("\u9009\u62E9\u6587\u4EF6\u5939"),$e=L(" \u91CD\u65B0\u540C\u6B65 "),Oe=Te(()=>g("span",{class:"order-explain"},"\u6839\u636E",-1)),ze={class:"pagination-line"},Ve={class:"pic-box"},Ne=["src","onClick","onContextmenu"],Re=["title"],je={class:"pagination-line"},Ue=H({setup(e){const s=p(!1),a=p(S("SELECTED_PATH")||""),v=p([]),l=p(0),o=p(1),d=p(S("PAGE_SIZE")||Pe),I=p([]),C=p(S("ORDER_BY")||"create_time"),m=p(S("ORDER_TYPE")||"DESC"),k=p(""),x=p(""),z=(n,t)=>`${a.value}/${n}/${t}`,Q=async n=>{for(const[t,{project_folder:r,preview:c}]of n.entries()){const F=await ke(z(r,c));I.value.splice(t,1,F)}},w=async n=>{if(!a.value)return;window.scrollTo(0,0);const t=await Be(a.value,C.value,m.value,n,d.value,x.value);if(t.success&&t.data){const r=t.data.list;v.value=r,l.value=t.data.total,I.value=new Array(r.length).fill(void 0),Q(r)}},V=async n=>{s.value=!0;const t=new Promise(c=>setTimeout(c,500)),r=await De(n);t.then(()=>{if(s.value=!1,r.success&&r.data){const c=`\u6210\u529F\u540C\u6B65 ${r.data.length} \uFF0C\u65B0\u589E ${r.data.newCount} \uFF0C\u6E05\u9664 ${r.data.invalidCount} \u3002`;U({showClose:!0,message:c,type:"success",duration:3e3}),console.log(c),o.value===1&&w(1),o.value=1}})},W=async()=>{s.value=!0;const n=await Ie();n.success&&n.data?(a.value=n.data,h("SELECTED_PATH",n.data),V(n.data)):s.value=!1},X=()=>{m.value=m.value==="ASC"?"DESC":"ASC"},N=({project_folder:n,file:t},r)=>{Se(z(n,t),r)};return document.addEventListener("keydown",n=>{["ArrowLeft"].includes(n.code)?o.value>1&&(o.value-=1):["ArrowRight"].includes(n.code)&&o.value<Math.ceil(l.value/d.value)&&(o.value+=1)}),G([d,C,m,x],([n,t,r],[c,F,A])=>{if(n!==c&&h("PAGE_SIZE",n),t!==F&&h("ORDER_BY",t),r!==A&&h("ORDER_TYPE",r),o.value!==1){o.value=1;return}w(o.value)}),G([o],([n])=>{w(n)}),w(o.value),(n,t)=>{const r=le,c=ue,F=re,A=ie,ee=ce,te=de,R=pe,oe=ve;return E(),y(P,null,[g("div",be,[i(F,{placement:"bottom",content:a.value,disabled:!a.value},{default:_(()=>[i(c,{onClick:W,loading:s.value},{default:_(()=>[T(i(r,{style:{"margin-right":"6px"}},{default:_(()=>[T(i(f(me),null,null,512),[[b,!a.value]]),T(i(f(Fe),{color:"#67C23A"},null,512),[[b,a.value]])]),_:1},512),[[b,!s.value]]),ye(n.$slots,"default",{},()=>[Le],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),a.value?(E(),y(P,{key:0},[i(c,{onClick:t[0]||(t[0]=()=>V(a.value)),icon:f(ge),loading:s.value},{default:_(()=>[$e]),_:1},8,["icon","loading"]),Oe,i(ee,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=u=>C.value=u),loading:s.value,style:{"margin-left":"12px",width:"120px"}},{default:_(()=>[i(A,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),i(A,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),i(c,{onClick:X,icon:f(fe),loading:s.value,style:{"margin-left":"12px"}},{default:_(()=>[L($(m.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"]),i(te,{modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=u=>k.value=u),placeholder:"\u8F93\u5165\u540D\u79F0",style:{"margin-left":"12px",width:"200px"}},{append:_(()=>[i(c,{icon:f(Ce),onClick:t[2]||(t[2]=u=>x.value=k.value)},null,8,["icon"])]),_:1},8,["modelValue"])],64)):M("",!0)]),g("div",ze,[i(R,{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=u=>o.value=u),"page-size":d.value,"onUpdate:page-size":t[5]||(t[5]=u=>d.value=u),"page-sizes":f(Z),total:l.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])]),v.value.length===0?(E(),q(oe,{key:0,description:"\u4EC0\u4E48\u90FD\u6CA1\u6709~"})):M("",!0),g("div",Ve,[(E(!0),y(P,null,Y(v.value,(u,j)=>(E(),y("div",{key:j,class:"pic-item"},[g("img",{class:"img",alt:"",src:I.value[j],onClick:ne=>N(u),onContextmenu:ne=>N(u,!0)},null,40,Ne),g("p",{title:u.title}," ["+$(f(he)(u.file_size))+"]\xA0"+$(u.title),9,Re)]))),128)),(E(),y(P,null,Y(10,u=>g("div",{key:u,class:"pic-item",style:{"margin-top":"0"}})),64))]),g("div",je,[i(R,{currentPage:o.value,"onUpdate:currentPage":t[6]||(t[6]=u=>o.value=u),"page-size":d.value,"onUpdate:page-size":t[7]||(t[7]=u=>d.value=u),"page-sizes":f(Z),total:l.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var He=xe(Ue,[["__scopeId","data-v-0dedbc68"]]);const Ge=H({setup(e){return(s,a)=>(E(),q(He))}});console.log("APP_VERSION","20220217a");we(Ge).mount("#app");

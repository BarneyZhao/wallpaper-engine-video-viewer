import{d as I,r as p,w as V,E as Z,a as G,b as H,c as M,o as _,e as m,f as c,g as f,h as x,t as k,i as L,v as q,u as b,F as w,j as z,p as J,k as R,l as B,m as P,n as K,q as Y}from"./vendor.4471e152.js";const Q=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))g(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&g(u)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};Q();const W=20,D=[10,20,30,40,50];function N(i,n){window.localStorage.setItem(i,JSON.stringify(n))}function h(i){const n=window.localStorage.getItem(i);return n&&JSON.parse(n)}var X=(i,n)=>{for(const[r,g]of n)i[r]=g;return i};const ee=i=>(J("data-v-488ee6f9"),i=i(),R(),i),te={class:"folder-line"},oe=P("\u9009\u62E9\u6587\u4EF6\u5939"),se={class:"folder-path"},ae=P("\xA0\xA0"),ne=[ae],le=P("\u91CD\u65B0\u540C\u6B65"),ie=ee(()=>c("span",null,"\xA0\xA0",-1)),re={class:"pagination-line"},ue={class:"pic-box"},ce=["src","onClick"],de=["title"],pe={class:"pagination-line"},ge=I({setup(i){console.log(window.electron);const n=p(!1),r=p(h("SELECTED_PATH")||""),g=p([]),s=p(0),o=p(1),u=p(h("PAGE_SIZE")||W),E=p([]),F=p(h("DYNAMIC_PAGE_SIZE")||!1),A=(e,t)=>`${r.value+e}/${t}`,T=e=>window.electron.getImg(A(e.project_folder,e.preview)),j=async e=>{for(const[t,a]of e.entries()){const d=await T(a);E.value.splice(t,1,d)}},$=e=>{window.electron.apis.openFile(A(e.project_folder,e.file))},y=async(e,t,a)=>{!e||window.electron.apis.getProjectsByPage(e,t,a).then(d=>{console.log("getProjects res",d);const v=d.data.list;g.value=v,s.value=d.data.total,E.value=new Array(v.length).fill(void 0),j(v)})},C=async e=>{n.value=!0;const t=new Promise(d=>setTimeout(d,500)),a=await window.electron.apis.scanProjectsToDb(e);t.then(()=>{n.value=!1,console.log("scanRes",a),a.success?(B({message:`\u6210\u529F\u540C\u6B65 ${a.data.length} \uFF0C\u65B0\u589E ${a.data.newCount} \uFF0C\u6E05\u9664 ${a.data.invalidCount} \u3002`,type:"success",duration:1500}),o.value===1&&y(r.value,1,u.value),o.value=1):(console.log(a.msg),B({message:`\u53D1\u751F\u4E86\u9519\u8BEF\uFF1A ${a.msg}`,type:"error",duration:1800}))})},O=async()=>{const e=await window.electron.apis.selectFolder();e.success&&e.data&&(r.value=e.data,N("SELECTED_PATH",e.data),C(e.data))};return V([o,u],([e,t],[,a])=>{if(t!==a&&(N("PAGE_SIZE",t),e!==1)){o.value=1;return}y(r.value,e,t)}),y(r.value,o.value,u.value),(e,t)=>{const a=Z,d=G,v=H,U=M;return _(),m(w,null,[c("div",te,[f(a,{onClick:O},{default:x(()=>[oe]),_:1}),c("div",se,[c("span",null,k(r.value),1),L(c("span",null,ne,512),[[U,n.value]])]),L(f(a,{onClick:t[0]||(t[0]=()=>C(r.value))},{default:x(()=>[le]),_:1},512),[[q,r.value]]),ie,f(d,{modelValue:F.value,"onUpdate:modelValue":t[1]||(t[1]=l=>F.value=l),label:"\u52A8\u6001\u6761\u6570",border:""},null,8,["modelValue"])]),c("div",re,[f(v,{currentPage:o.value,"onUpdate:currentPage":t[2]||(t[2]=l=>o.value=l),"page-size":u.value,"onUpdate:page-size":t[3]||(t[3]=l=>u.value=l),"page-sizes":b(D),total:s.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),c("div",ue,[(_(!0),m(w,null,z(g.value,(l,S)=>(_(),m("div",{key:S,class:"pic-item"},[c("img",{class:"img",alt:"",src:E.value[S],onClick:fe=>$(l)},null,8,ce),c("p",{title:l.title},k(l.title),9,de)]))),128)),(_(),m(w,null,z(10,l=>c("div",{key:l,class:"pic-item",style:{"margin-top":"0"}})),64))]),c("div",pe,[f(v,{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=l=>o.value=l),"page-size":u.value,"onUpdate:page-size":t[5]||(t[5]=l=>u.value=l),"page-sizes":b(D),total:s.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var ve=X(ge,[["__scopeId","data-v-488ee6f9"]]);const _e=I({setup(i){return(n,r)=>(_(),K(ve))}});Y(_e).mount("#app");

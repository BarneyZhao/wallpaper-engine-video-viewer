import{E as J,a as j,d as U,r as p,w as Q,b as W,c as X,e as ee,f as te,g as oe,o as _,h as C,i as v,j as d,k as m,l as I,v as b,u as E,m as se,n as ne,p as ae,F as h,q as le,s as L,t as O,x as ue,y as re,z as G,A as ie,B as ce,C as de,D as pe,G as ve}from"./vendor.e69e533c.js";const ge=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))g(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&g(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerpolicy&&(o.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?o.credentials="include":l.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}};ge();const fe=20,H=[10,20,30,40,50];function A(e,s){window.localStorage.setItem(e,JSON.stringify(s))}function S(e){const s=window.localStorage.getItem(e);return s&&JSON.parse(s)}function Ee(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const M="1.1.1",T=Boolean(window.electron),_e=async()=>{if(!T)return;const e=(await window.electron.apis.getAppVersion()).data;console.log("ELECTRON_VERSION",e),M!==e&&J({title:`\u6709\u65B0\u7684\u7248\u672C(${M})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};_e();const $=e=>{j({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},B=async(e,...s)=>T?(console.log(`request: ${e}`,s),window.electron.apis[e](...s).then(n=>(console.log("response:",n),n.success||($(n.message),console.error(n.message)),n)).catch(n=>($("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(n),{success:!1}))):($("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1}),me=(...e)=>B("openFileOrFolder",...e),ye=(...e)=>B("getProjectsByPage",...e),Fe=(...e)=>B("scanProjectsToDb",...e),Ce=(...e)=>B("selectFolder",...e),we=async e=>T?window.electron.getImg(e):"";var Pe=(e,s)=>{for(const[n,g]of s)e[n]=g;return e};const he=e=>(ie("data-v-7eb741e0"),e=e(),ce(),e),Ae={class:"folder-line"},Se=L("\u9009\u62E9\u6587\u4EF6\u5939"),Be=L(" \u91CD\u65B0\u540C\u6B65 "),De=he(()=>v("span",{class:"order-explain"},"\u6839\u636E",-1)),ke={class:"pagination-line"},xe={class:"pic-box"},Ie=["src","onClick","onContextmenu"],be=["title"],Le={class:"pagination-line"},Oe=U({setup(e){const s=p(!1),n=p(S("SELECTED_PATH")||""),g=p([]),l=p(0),o=p(1),c=p(S("PAGE_SIZE")||fe),D=p([]),w=p(S("ORDER_BY")||"create_time"),y=p(S("ORDER_TYPE")||"DESC"),z=(a,t)=>`${n.value}/${a}/${t}`,Y=async a=>{for(const[t,{project_folder:u,preview:r}]of a.entries()){const F=await we(z(u,r));D.value.splice(t,1,F)}},k=async(a,t)=>{if(!n.value)return;const u=await ye(n.value,w.value,y.value,a,t);if(u.success&&u.data){const r=u.data.list;g.value=r,l.value=u.data.total,D.value=new Array(r.length).fill(void 0),Y(r)}},R=async a=>{s.value=!0;const t=new Promise(r=>setTimeout(r,500)),u=await Fe(a);t.then(()=>{if(s.value=!1,u.success&&u.data){const r=`\u6210\u529F\u540C\u6B65 ${u.data.length} \uFF0C\u65B0\u589E ${u.data.newCount} \uFF0C\u6E05\u9664 ${u.data.invalidCount} \u3002`;j({showClose:!0,message:r,type:"success",duration:3e3}),console.log(r),o.value===1&&k(1,c.value),o.value=1}})},Z=async()=>{s.value=!0;const a=await Ce();a.success&&a.data?(n.value=a.data,A("SELECTED_PATH",a.data),R(a.data)):s.value=!1},q=()=>{y.value=y.value==="ASC"?"DESC":"ASC"},N=({project_folder:a,file:t},u)=>{me(z(a,t),u)};return document.addEventListener("keydown",a=>{["ArrowLeft","KeyA"].includes(a.code)?o.value>1&&(o.value-=1):["ArrowRight","KeyD"].includes(a.code)&&o.value<Math.ceil(l.value/c.value)&&(o.value+=1)}),Q([o,c,w,y],([a,t,u,r],[,F,P,x])=>{let f=!1;if(t!==F&&(A("PAGE_SIZE",t),f=!0),u!==P&&(A("ORDER_BY",u),f=!0),r!==x&&(A("ORDER_TYPE",r),f=!0),f&&a!==1){o.value=1;return}k(a,t)}),k(o.value,c.value),(a,t)=>{const u=de,r=W,F=X,P=ee,x=te,f=oe;return _(),C(h,null,[v("div",Ae,[d(F,{placement:"bottom",content:n.value,disabled:!n.value},{default:m(()=>[d(r,{onClick:Z,loading:s.value},{default:m(()=>[I(d(u,{style:{"margin-right":"6px"}},{default:m(()=>[I(d(E(se),null,null,512),[[b,!n.value]]),I(d(E(ne),{color:"#67C23A"},null,512),[[b,n.value]])]),_:1},512),[[b,!s.value]]),ae(a.$slots,"default",{},()=>[Se],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),n.value?(_(),C(h,{key:0},[d(r,{onClick:t[0]||(t[0]=()=>R(n.value)),icon:E(le),loading:s.value},{default:m(()=>[Be]),_:1},8,["icon","loading"]),De,d(x,{modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=i=>w.value=i),loading:s.value,style:{"margin-left":"12px",width:"120px"}},{default:m(()=>[d(P,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),d(P,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),d(r,{onClick:q,icon:E(ue),loading:s.value,style:{"margin-left":"12px"}},{default:m(()=>[L(O(y.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"])],64)):re("",!0)]),v("div",ke,[d(f,{currentPage:o.value,"onUpdate:currentPage":t[2]||(t[2]=i=>o.value=i),"page-size":c.value,"onUpdate:page-size":t[3]||(t[3]=i=>c.value=i),"page-sizes":E(H),total:l.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),v("div",xe,[(_(!0),C(h,null,G(g.value,(i,V)=>(_(),C("div",{key:V,class:"pic-item"},[v("img",{class:"img",alt:"",src:D.value[V],onClick:K=>N(i),onContextmenu:K=>N(i,!0)},null,40,Ie),v("p",{title:i.title}," ["+O(E(Ee)(i.file_size))+"]\xA0"+O(i.title),9,be)]))),128)),(_(),C(h,null,G(10,i=>v("div",{key:i,class:"pic-item",style:{"margin-top":"0"}})),64))]),v("div",Le,[d(f,{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=i=>o.value=i),"page-size":c.value,"onUpdate:page-size":t[5]||(t[5]=i=>c.value=i),"page-sizes":E(H),total:l.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var Te=Pe(Oe,[["__scopeId","data-v-7eb741e0"]]);const $e=U({setup(e){return(s,n)=>(_(),pe(Te))}});console.log("APP_VERSION","1.1.0");ve($e).mount("#app");

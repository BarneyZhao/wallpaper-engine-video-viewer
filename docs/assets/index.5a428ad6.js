import{E as N,d as j,r as p,w as Q,a as W,b as X,c as ee,e as te,f as oe,g as ne,o as E,h as w,i as v,j as d,k as m,F as h,u as _,l as se,s as ae,m as le,n as U,p as ue,q as re,t as I,v as b,x as ie,y as ce,z as de,A as L,B as $,C as pe,D as ve}from"./vendor.5f78c1a3.js";const fe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))f(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&f(c)}).observe(document,{childList:!0,subtree:!0});function l(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function f(a){if(a.ep)return;a.ep=!0;const o=l(a);fetch(a.href,o)}};fe();const ge=20,G=[10,20,30,40,50];function A(e,n){window.localStorage.setItem(e,JSON.stringify(n))}function S(e){const n=window.localStorage.getItem(e);return n&&JSON.parse(n)}function _e(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const H="1.1.0",M=Boolean(window.electron),Ee=M?window.electron.apis.getAppVersion():new Promise(e=>e("")),me=e=>{N({showClose:!0,message:e,type:"success",duration:2500}),console.log(e)},z=e=>{N({showClose:!0,message:e,type:"error",duration:2500}),console.error(e)},Y=async()=>{if(!M)return z("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u63A5\u53E3\u4E0D\u53EF\u7528"),!1;const e=(await Ee).data;return H!==e?(z(`\u524D\u7AEF\u7248\u672C(${H})\u548C\u57FA\u5EA7\u7248\u672C(${e})\u4E0D\u5339\u914D`),!1):!0},D=async(e,...n)=>{if(!!await Y())return console.log(`request: ${e}`,n),window.electron.apis[e](...n).then(l=>(console.log("response:",l),l))},ye=(...e)=>D("openFileOrFolder",...e),Fe=(...e)=>D("getProjectsByPage",...e),we=(...e)=>D("scanProjectsToDb",...e),Ce=(...e)=>D("selectFolder",...e),Pe=async e=>await Y()?window.electron.getImg(e):"";var he=(e,n)=>{for(const[l,f]of n)e[l]=f;return e};const Ae=e=>(ue("data-v-07e2b05d"),e=e(),re(),e),Se={class:"folder-line"},De=L("\u9009\u62E9\u6587\u4EF6\u5939"),Be=L(" \u91CD\u65B0\u540C\u6B65 "),ke=Ae(()=>v("span",{class:"order-explain"},"\u6839\u636E",-1)),xe={class:"pagination-line"},Ie={class:"pic-box"},be=["src","onClick","onContextmenu"],Le=["title"],$e={class:"pagination-line"},ze=j({setup(e){const n=p(!1),l=p(S("SELECTED_PATH")||""),f=p([]),a=p(0),o=p(1),c=p(S("PAGE_SIZE")||ge),B=p([]),C=p(S("ORDER_BY")||"create_time"),y=p(S("ORDER_TYPE")||"DESC"),T=(s,t)=>`${l.value}/${s}/${t}`,Z=async s=>{for(const[t,{project_folder:u,preview:i}]of s.entries()){const F=await Pe(T(u,i));B.value.splice(t,1,F)}},k=async(s,t)=>{!l.value||Fe(l.value,C.value,y.value,s,t).then(u=>{const i=u.data.list;f.value=i,a.value=u.data.total,B.value=new Array(i.length).fill(void 0),Z(i)})},O=async s=>{n.value=!0;const t=new Promise(i=>setTimeout(i,500)),u=await we(s);t.then(()=>{n.value=!1,u.success?(me(`\u6210\u529F\u540C\u6B65 ${u.data.length} \uFF0C\u65B0\u589E ${u.data.newCount} \uFF0C\u6E05\u9664 ${u.data.invalidCount} \u3002`),o.value===1&&k(1,c.value),o.value=1):z(`\u53D1\u751F\u4E86\u9519\u8BEF\uFF1A ${u.msg}`)})},q=async()=>{n.value=!0;const s=await Ce();s.success&&s.data?(l.value=s.data,A("SELECTED_PATH",s.data),O(s.data)):n.value=!1},K=()=>{y.value=y.value==="ASC"?"DESC":"ASC"},V=({project_folder:s,file:t},u)=>{ye(T(s,t),u)};return document.addEventListener("keydown",s=>{["ArrowLeft","KeyA"].includes(s.code)?o.value>1&&(o.value-=1):["ArrowRight","KeyD"].includes(s.code)&&o.value<Math.ceil(a.value/c.value)&&(o.value+=1)}),Q([o,c,C,y],([s,t,u,i],[,F,P,x])=>{let g=!1;if(t!==F&&(A("PAGE_SIZE",t),g=!0),u!==P&&(A("ORDER_BY",u),g=!0),i!==x&&(A("ORDER_TYPE",i),g=!0),g&&s!==1){o.value=1;return}k(s,t)}),k(o.value,c.value),(s,t)=>{const u=W,i=X,F=ee,P=te,x=oe,g=ne;return E(),w(h,null,[v("div",Se,[d(F,{placement:"bottom",content:l.value,disabled:!l.value},{default:m(()=>[d(i,{onClick:q,loading:n.value},{default:m(()=>[I(d(u,{style:{"margin-right":"6px"}},{default:m(()=>[I(d(_(ie),null,null,512),[[b,!l.value]]),I(d(_(ce),{color:"#67C23A"},null,512),[[b,l.value]])]),_:1},512),[[b,!n.value]]),de(s.$slots,"default",{},()=>[De],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),l.value?(E(),w(h,{key:0},[d(i,{onClick:t[0]||(t[0]=()=>O(l.value)),icon:_(se),loading:n.value},{default:m(()=>[Be]),_:1},8,["icon","loading"]),ke,d(x,{modelValue:C.value,"onUpdate:modelValue":t[1]||(t[1]=r=>C.value=r),loading:n.value,style:{"margin-left":"12px",width:"120px"}},{default:m(()=>[d(P,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),d(P,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),d(i,{onClick:K,icon:_(ae),loading:n.value,style:{"margin-left":"12px"}},{default:m(()=>[L($(y.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"])],64)):le("",!0)]),v("div",xe,[d(g,{currentPage:o.value,"onUpdate:currentPage":t[2]||(t[2]=r=>o.value=r),"page-size":c.value,"onUpdate:page-size":t[3]||(t[3]=r=>c.value=r),"page-sizes":_(G),total:a.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),v("div",Ie,[(E(!0),w(h,null,U(f.value,(r,R)=>(E(),w("div",{key:R,class:"pic-item"},[v("img",{class:"img",alt:"",src:B.value[R],onClick:J=>V(r),onContextmenu:J=>V(r,!0)},null,40,be),v("p",{title:r.title}," ["+$(_(_e)(r.file_size))+"]\xA0"+$(r.title),9,Le)]))),128)),(E(),w(h,null,U(10,r=>v("div",{key:r,class:"pic-item",style:{"margin-top":"0"}})),64))]),v("div",$e,[d(g,{currentPage:o.value,"onUpdate:currentPage":t[4]||(t[4]=r=>o.value=r),"page-size":c.value,"onUpdate:page-size":t[5]||(t[5]=r=>c.value=r),"page-sizes":_(G),total:a.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var Te=he(ze,[["__scopeId","data-v-07e2b05d"]]);const Oe=j({setup(e){return(n,l)=>(E(),pe(Te))}});ve(Oe).mount("#app");

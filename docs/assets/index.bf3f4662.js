var ye=Object.defineProperty,Fe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var J=(e,t,s)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,K=(e,t)=>{for(var s in t||(t={}))Ae.call(t,s)&&J(e,s,t[s]);if(Z)for(var s of Z(t))Pe.call(t,s)&&J(e,s,t[s]);return e},Q=(e,t)=>Fe(e,he(t));import{s as we,E as Se,a as R,d as X,r as v,w as H,b as Be,c as De,e as be,f as Ie,g as xe,h as Te,i as ke,j as Ve,k as Le,o as C,l as P,m as g,n as r,p as f,F as x,u as m,q as Oe,t as ee,v as te,x as oe,y as $e,z as Ne,A as U,B as j,C as ze,D as Re,G as He,H as Ue,I as Y,J as G,K as je,L as Ye}from"./vendor.b43bad09.js";const Ge=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const E of d.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&c(E)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerpolicy&&(d.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?d.credentials="include":u.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function c(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}};Ge();const Me=20,se=[10,20,30,40,50],ne="1.4.0";function y(e,t){window.localStorage.setItem(e,JSON.stringify(t))}function F(e){const t=window.localStorage.getItem(e);return t&&JSON.parse(t)}function qe(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const ae="SELECTED_PATH",We="SELECTED_COPY_PATH",le="SYNC_INFO",ue="PAGE_SIZE",ie="ORDER_BY",re="ORDER_TYPE",ce="CHECK_REPEAT",Ze=["getAppVersion","showContextmenus","selectFolder","openFile","openDbFileFolder","scanProjectsToDb","getProjectsByPage","checkEverything"],T=window.electron,M=Boolean(T),de=async()=>{if(!M)return;const e=(await T.apis.getAppVersion()).data;console.log("ELECTRON_VERSION:",e),e&&we.gt(ne,e)&&Se({title:`\u6709\u65B0\u7684\u7248\u672C(${ne})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};de();const k=e=>{R({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},Je=async(e,...t)=>{if(!M)return k("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1};const s=T.apis;return s[e]?(console.log(`request: ${e}`,t),s[e](...t).then(c=>(console.log("response:",c),c.success||(k(c.message),console.error(c.message)),c)).catch(c=>(k("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(c),{success:!1}))):(k(`Electron \u63A5\u53E3[${e}]\u4E0D\u5B58\u5728\uFF0C\u8BF7\u786E\u8BA4\u7248\u672C`),de(),{success:!1})},w=Ze.reduce((e,t)=>Q(K({},e),{[t]:(...s)=>Je(t,...s)}),{}),Ke=async e=>M?T.getImg(e):"";var Qe=(e,t)=>{for(const[s,c]of t)e[s]=c;return e};const Xe=e=>($e("data-v-7ede348b"),e=e(),Ne(),e),et={class:"folder-line"},tt=Y("\u9009\u62E9\u6587\u4EF6\u5939"),ot=Y(" \u91CD\u65B0\u540C\u6B65 "),st=Xe(()=>g("span",{class:"order-explain"},"\u6839\u636E",-1)),nt={class:"pagination-line"},at={class:"pic-box"},lt=["src","onClick","onContextmenu"],ut=["title"],it={class:"pagination-line"},rt=X({setup(e){const t=v(!1),s=v(F(ae)||""),c=v(F(We)||""),u=v(F(le)||{syncWhenInit:!1,timestamp:""}),d=v([]),E=v(0),p=v(1),_=v(F(ue)||Me),V=v([]),S=v(F(ie)||"create_time"),A=v(F(re)||"DESC"),L=v(""),O=v(""),B=v(F(ce)||!1),$=(n,o)=>`${s.value}/${n}/${o}`,pe=async n=>{for(const[o,{project_folder:a,preview:i}]of n.entries()){const h=await Ke($(a,i));V.value.splice(o,1,h)}},D=async n=>{if(!s.value)return;window.scrollTo(0,0);const o=await w.getProjectsByPage({folderPath:s.value,orderBy:S.value,orderType:A.value,pageNo:n,pageSize:_.value,title:O.value,checkRepeat:B.value});if(o.success&&o.data){const a=o.data.list;d.value=a,E.value=o.data.total,V.value=new Array(a.length).fill(void 0),pe(a)}},N=async n=>{t.value=!0;const o=new Promise(i=>setTimeout(i,500)),a=await w.scanProjectsToDb(n);o.then(()=>{if(t.value=!1,a.success&&a.data){u.value.timestamp=a.data.timestamp;const i=`\u6210\u529F\u540C\u6B65 ${a.data.length} \uFF0C\u65B0\u589E ${a.data.newCount} \uFF0C\u6E05\u9664 ${a.data.invalidCount} \u3002`;R({showClose:!0,message:i,type:"success",duration:3e3}),console.log(i),p.value===1&&D(1),p.value=1}})},ve=async()=>{t.value=!0;const n=await w.selectFolder();n.success&&n.data?(s.value=n.data,y(ae,n.data),N(n.data)):t.value=!1},Ee=()=>{A.value=A.value==="ASC"?"DESC":"ASC"},ge=({project_folder:n,file:o})=>{w.openFile($(n,o))},fe=async({project_folder:n,file:o})=>{var i;const a=await w.showContextmenus($(n,o),c.value).catch(console.error);(a==null?void 0:a.success)&&((i=a.data)==null?void 0:i.act)==="copied"&&(c.value=a.data.path||"",y("SELECTED_COPY_PATH",a.data.path),R({showClose:!0,message:"\u590D\u5236\u5B8C\u6210",type:"success",duration:1e4}))};return document.addEventListener("keydown",n=>{["ArrowLeft"].includes(n.code)?p.value>1&&(p.value-=1):["ArrowRight"].includes(n.code)&&p.value<Math.ceil(E.value/_.value)&&(p.value+=1)}),H([_,S,A,B,O],([n,o,a,i],[h,b,I,z])=>{if(n!==h&&y(ue,n),o!==b&&y(ie,o),a!==I&&y(re,a),i!==z&&y(ce,i),p.value!==1){p.value=1;return}D(p.value)}),H([p],([n])=>{D(n)}),H([u],([n])=>{y(le,n)}),s.value&&u.value.syncWhenInit?N(s.value):D(p.value),(n,o)=>{const a=Be,i=De,h=be,b=Ie,I=xe,z=Te,me=ke,q=Ve,_e=Le;return C(),P(x,null,[g("div",et,[r(h,{placement:"bottom",content:s.value,disabled:!s.value},{default:f(()=>[r(i,{onClick:ve,loading:t.value},{default:f(()=>[U(r(a,{style:{"margin-right":"6px"}},{default:f(()=>[U(r(m(ze),null,null,512),[[j,!s.value]]),U(r(m(Re),{color:"#67C23A"},null,512),[[j,s.value]])]),_:1},512),[[j,!t.value]]),He(n.$slots,"default",{},()=>[tt],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),s.value?(C(),P(x,{key:0},[r(h,{placement:"bottom",content:`\u4E0A\u6B21\u540C\u6B65: ${u.value.timestamp}`,disabled:!u.value.timestamp},{default:f(()=>[r(i,{onClick:o[0]||(o[0]=()=>N(s.value)),icon:m(Ue),loading:t.value},{default:f(()=>[ot]),_:1},8,["icon","loading"])]),_:1},8,["content","disabled"]),r(b,{modelValue:u.value.syncWhenInit,"onUpdate:modelValue":o[1]||(o[1]=l=>u.value.syncWhenInit=l),label:"\u542F\u52A8\u65F6\u81EA\u52A8\u540C\u6B65",style:{margin:"0 0 0 12px"}},null,8,["modelValue"]),st,r(z,{modelValue:S.value,"onUpdate:modelValue":o[2]||(o[2]=l=>S.value=l),loading:t.value,style:{"margin-left":"12px",width:"120px"}},{default:f(()=>[r(I,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),r(I,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),r(i,{onClick:Ee,icon:m(Oe),loading:t.value,style:{"margin-left":"12px"}},{default:f(()=>[Y(G(A.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"]),r(me,{modelValue:L.value,"onUpdate:modelValue":o[4]||(o[4]=l=>L.value=l),placeholder:"\u8F93\u5165\u540D\u79F0\u641C\u7D22",style:{"margin-left":"12px",width:"200px"}},{append:f(()=>[r(i,{icon:m(je),onClick:o[3]||(o[3]=l=>O.value=L.value)},null,8,["icon"])]),_:1},8,["modelValue"]),r(b,{modelValue:B.value,"onUpdate:modelValue":o[5]||(o[5]=l=>B.value=l),label:"\u67E5\u91CD\u6A21\u5F0F",border:"",style:{"margin-left":"12px"}},null,8,["modelValue"])],64)):ee("",!0)]),g("div",nt,[r(q,{currentPage:p.value,"onUpdate:currentPage":o[6]||(o[6]=l=>p.value=l),"page-size":_.value,"onUpdate:page-size":o[7]||(o[7]=l=>_.value=l),"page-sizes":m(se),total:E.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])]),d.value.length===0?(C(),te(_e,{key:0,description:"\u4EC0\u4E48\u90FD\u6CA1\u6709~"})):ee("",!0),g("div",at,[(C(!0),P(x,null,oe(d.value,(l,W)=>(C(),P("div",{key:W,class:"pic-item"},[g("img",{class:"img",alt:"",src:V.value[W],onClick:Ce=>ge(l),onContextmenu:Ce=>fe(l)},null,40,lt),g("p",{title:l.title}," ["+G(m(qe)(l.file_size))+"]\xA0"+G(l.title),9,ut)]))),128)),(C(),P(x,null,oe(10,l=>g("div",{key:l,class:"pic-item",style:{"margin-top":"0"}})),64))]),g("div",it,[r(q,{currentPage:p.value,"onUpdate:currentPage":o[8]||(o[8]=l=>p.value=l),"page-size":_.value,"onUpdate:page-size":o[9]||(o[9]=l=>_.value=l),"page-sizes":m(se),total:E.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var ct=Qe(rt,[["__scopeId","data-v-7ede348b"]]);const dt=X({setup(e){return(t,s)=>(C(),te(ct))}});console.log("APP_VERSION:","20221101a");Ye(dt).mount("#app");

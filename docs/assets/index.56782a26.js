var he=Object.defineProperty,Ae=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var J=(e,t,n)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,K=(e,t)=>{for(var n in t||(t={}))De.call(t,n)&&J(e,n,t[n]);if(Z)for(var n of Z(t))Ie.call(t,n)&&J(e,n,t[n]);return e},Q=(e,t)=>Ae(e,Pe(t));import{s as Se,E as we,a as X,d as ee,r as v,w as H,b as Be,c as Te,e as Ne,f as ke,g as xe,h as be,i as Oe,j as Le,k as Ve,l as Re,o as y,m as P,n as _,p as c,q as g,F as k,u as f,t as $e,v as te,x as oe,y as ne,z as ze,A as Ue,B as G,C as Y,D as He,G as Ge,H as Ye,I as Me,J as M,K as j,L as je,M as qe}from"./vendor.036afa09.js";const We=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&d(m)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}};We();const Ze=20,ae=[10,20,30,40,50],se="1.4.0";function F(e,t){window.localStorage.setItem(e,JSON.stringify(t))}function h(e){const t=window.localStorage.getItem(e);return t&&JSON.parse(t)}function Je(e){return e?e<1024?`${e}KB`:1024<=e&&e<1048576?`${(e/1024).toFixed(2)}MB`:`${(e/1048576).toFixed(2)}GB`:"??"}const le="SELECTED_PATH",Ke="SELECTED_COPY_PATH",ue="SYNC_INFO",ie="PAGE_SIZE",ce="ORDER_BY",re="ORDER_TYPE",de="CHECK_REPEAT",Qe=["getAppVersion","showContextmenus","selectFolder","openFile","openDbFileFolder","scanProjectsToDb","getProjectsByPage","checkEverything"];var D;(function(e){e[e.NORMAL=0]="NORMAL",e[e.RUNING=1]="RUNING",e[e.COPIED=2]="COPIED"})(D||(D={}));const x=window.electron,q=Boolean(x),pe=async()=>{if(!q)return;const e=(await x.apis.getAppVersion()).data;console.log("ELECTRON_VERSION:",e),e&&Se.gt(se,e)&&we({title:`\u6709\u65B0\u7684\u7248\u672C(${se})\u53EF\u7528\uFF0C\u5EFA\u8BAE\u66F4\u65B0`,dangerouslyUseHTMLString:!0,message:`\u5F53\u524D\u7248\u672C\uFF1A${e}`,position:"bottom-right",duration:0})};pe();const b=e=>{X({showClose:!0,message:e,type:"error",duration:0}),console.error(e||"\u51FA\u9519\u4E86")},Xe=async(e,...t)=>{if(!q)return b("\u5F53\u524D\u975E Electron \u73AF\u5883\uFF0C\u5E94\u7528\u65E0\u6CD5\u8C03\u7528\u63A5\u53E3"),{success:!1};const n=x.apis;return n[e]?(console.log(`request: ${e}`,t),n[e](...t).then(d=>(console.log("response:",d),d.success||(b(d.message),console.error(d.message)),d)).catch(d=>(b("\u63A5\u53E3\u51FA\u9519\u4E86"),console.error(d),{success:!1}))):(b(`Electron \u63A5\u53E3[${e}]\u4E0D\u5B58\u5728\uFF0C\u8BF7\u786E\u8BA4\u7248\u672C`),pe(),{success:!1})},I=Qe.reduce((e,t)=>Q(K({},e),{[t]:(...n)=>Xe(t,...n)}),{}),et=async e=>q?x.getImg(e):"";var tt=(e,t)=>{for(const[n,d]of t)e[n]=d;return e};const ot=e=>(ze("data-v-7d438c63"),e=e(),Ue(),e),nt={class:"folder-line"},at=M("\u9009\u62E9\u6587\u4EF6\u5939"),st=M(" \u91CD\u65B0\u540C\u6B65 "),lt=ot(()=>_("span",{class:"order-explain"},"\u6839\u636E",-1)),ut={class:"pagination-line"},it={class:"pic-box"},ct=["src","onClick","onContextmenu"],rt=["title"],dt={class:"pagination-line"},pt=ee({setup(e){const t=v(!1),n=v(h(le)||""),d=v(h(Ke)||""),l=v(h(ue)||{syncWhenInit:!1,timestamp:""}),r=v([]),m=v(0),p=v(1),C=v(h(ie)||Ze),O=v([]),S=v(h(ce)||"create_time"),A=v(h(re)||"DESC"),L=v(""),V=v(""),w=v(h(de)||!1),R=(a,o)=>`${n.value}/${a}/${o}`,ve=async a=>{for(const[o,{project_folder:i,preview:u}]of a.entries()){const E=await et(R(i,u));O.value.splice(o,1,E)}},B=async a=>{if(!n.value)return;window.scrollTo(0,0);const o=await I.getProjectsByPage({folderPath:n.value,orderBy:S.value,orderType:A.value,pageNo:a,pageSize:C.value,title:V.value,checkRepeat:w.value});if(o.success&&o.data){const i=o.data.list;r.value=i,m.value=o.data.total,O.value=new Array(i.length).fill(void 0),ve(i)}},$=async a=>{t.value=!0;const o=new Promise(u=>setTimeout(u,500)),i=await I.scanProjectsToDb(a);o.then(()=>{if(t.value=!1,i.success&&i.data){l.value.timestamp=i.data.timestamp;const u=`\u6210\u529F\u540C\u6B65 ${i.data.length} \uFF0C\u65B0\u589E ${i.data.newCount} \uFF0C\u6E05\u9664 ${i.data.invalidCount} \u3002`;X({showClose:!0,message:u,type:"success",duration:3e3}),console.log(u),p.value===1&&B(1),p.value=1}})},Ee=async()=>{t.value=!0;const a=await I.selectFolder();a.success&&a.data?(n.value=a.data,F(le,a.data),$(a.data)):t.value=!1},ge=()=>{A.value=A.value==="ASC"?"DESC":"ASC"},fe=({project_folder:a,file:o})=>{I.openFile(R(a,o))},me=async({project_folder:a,file:o},i)=>{var E;r.value[i].copyStuts=D.RUNING;const u=await I.showContextmenus(R(a,o),d.value).catch(console.error);(u==null?void 0:u.success)&&((E=u.data)==null?void 0:E.act)==="copied"&&(d.value=u.data.path||"",F("SELECTED_COPY_PATH",u.data.path),r.value[i].copyStuts=D.COPIED)};return document.addEventListener("keydown",a=>{["ArrowLeft"].includes(a.code)?p.value>1&&(p.value-=1):["ArrowRight"].includes(a.code)&&p.value<Math.ceil(m.value/C.value)&&(p.value+=1)}),H([C,S,A,w,V],([a,o,i,u],[E,T,N,z])=>{if(a!==E&&F(ie,a),o!==T&&F(ce,o),i!==N&&F(re,i),u!==z&&F(de,u),p.value!==1){p.value=1;return}B(p.value)}),H([p],([a])=>{B(a)}),H([l],([a])=>{F(ue,a)}),n.value&&l.value.syncWhenInit?$(n.value):B(p.value),(a,o)=>{const i=Be,u=Te,E=Ne,T=ke,N=xe,z=be,_e=Oe,W=Le,Ce=Ve,ye=Re;return y(),P(k,null,[_("div",nt,[c(E,{placement:"bottom",content:n.value,disabled:!n.value},{default:g(()=>[c(u,{onClick:Ee,loading:t.value},{default:g(()=>[G(c(i,{style:{"margin-right":"6px"}},{default:g(()=>[G(c(f(He),null,null,512),[[Y,!n.value]]),G(c(f(Ge),{color:"#67C23A"},null,512),[[Y,n.value]])]),_:1},512),[[Y,!t.value]]),Ye(a.$slots,"default",{},()=>[at],!0)]),_:3},8,["loading"])]),_:3},8,["content","disabled"]),n.value?(y(),P(k,{key:0},[c(E,{placement:"bottom",content:`\u4E0A\u6B21\u540C\u6B65: ${l.value.timestamp}`,disabled:!l.value.timestamp},{default:g(()=>[c(u,{onClick:o[0]||(o[0]=()=>$(n.value)),icon:f(Me),loading:t.value},{default:g(()=>[st]),_:1},8,["icon","loading"])]),_:1},8,["content","disabled"]),c(T,{modelValue:l.value.syncWhenInit,"onUpdate:modelValue":o[1]||(o[1]=s=>l.value.syncWhenInit=s),label:"\u542F\u52A8\u65F6\u81EA\u52A8\u540C\u6B65",style:{margin:"0 0 0 12px"}},null,8,["modelValue"]),lt,c(z,{modelValue:S.value,"onUpdate:modelValue":o[2]||(o[2]=s=>S.value=s),loading:t.value,style:{"margin-left":"12px",width:"120px"}},{default:g(()=>[c(N,{label:"\u521B\u5EFA\u65F6\u95F4",value:"create_time"}),c(N,{label:"\u6587\u4EF6\u5927\u5C0F",value:"file_size"})]),_:1},8,["modelValue","loading"]),c(u,{onClick:ge,icon:f($e),loading:t.value,style:{"margin-left":"12px"}},{default:g(()=>[M(j(A.value==="DESC"?"\u964D\u5E8F":"\u5347\u5E8F"),1)]),_:1},8,["icon","loading"]),c(_e,{modelValue:L.value,"onUpdate:modelValue":o[4]||(o[4]=s=>L.value=s),placeholder:"\u8F93\u5165\u540D\u79F0\u641C\u7D22",style:{"margin-left":"12px",width:"200px"}},{append:g(()=>[c(u,{icon:f(je),onClick:o[3]||(o[3]=s=>V.value=L.value)},null,8,["icon"])]),_:1},8,["modelValue"]),c(T,{modelValue:w.value,"onUpdate:modelValue":o[5]||(o[5]=s=>w.value=s),label:"\u67E5\u91CD\u6A21\u5F0F",border:"",style:{"margin-left":"12px"}},null,8,["modelValue"])],64)):te("",!0)]),_("div",ut,[c(W,{currentPage:p.value,"onUpdate:currentPage":o[6]||(o[6]=s=>p.value=s),"page-size":C.value,"onUpdate:page-size":o[7]||(o[7]=s=>C.value=s),"page-sizes":f(ae),total:m.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])]),r.value.length===0?(y(),oe(Ce,{key:0,description:"\u4EC0\u4E48\u90FD\u6CA1\u6709~"})):te("",!0),_("div",it,[(y(!0),P(k,null,ne(r.value,(s,U)=>(y(),P("div",{key:U,class:"pic-item"},[c(ye,{hidden:!s.copyStuts,value:s.copyStuts===f(D).RUNING?"\u590D\u5236\u4E2D":"\u5DF2\u590D\u5236"},{default:g(()=>[_("img",{class:"img",alt:"",src:O.value[U],onClick:Fe=>fe(s),onContextmenu:Fe=>me(s,U)},null,40,ct)]),_:2},1032,["hidden","value"]),_("p",{title:s.title}," ["+j(f(Je)(s.file_size))+"]\xA0"+j(s.title),9,rt)]))),128)),(y(),P(k,null,ne(10,s=>_("div",{key:s,class:"pic-item",style:{"margin-top":"0"}})),64))]),_("div",dt,[c(W,{currentPage:p.value,"onUpdate:currentPage":o[8]||(o[8]=s=>p.value=s),"page-size":C.value,"onUpdate:page-size":o[9]||(o[9]=s=>C.value=s),"page-sizes":f(ae),total:m.value,background:"",layout:"total, sizes, prev, pager, next"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var vt=tt(pt,[["__scopeId","data-v-7d438c63"]]);const Et=ee({setup(e){return(t,n)=>(y(),oe(vt))}});console.log("APP_VERSION:","20221107a");qe(Et).mount("#app");

import{d as S,r as g,w as O,E as U,a as H,b as Z,o as f,c as _,e as u,f as m,g as A,t as I,h as x,v as G,u as L,F as E,i as k,p as V,j as J,k as b,l as h,m as M,n as R}from"./vendor.9b3e9723.js";const q=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&p(c)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}};q();const K=20,B=[10,20,30,40,50];function z(l,n){window.localStorage.setItem(l,JSON.stringify(n))}function D(l){const n=window.localStorage.getItem(l);return n&&JSON.parse(n)}var Q=(l,n)=>{for(const[r,p]of n)l[r]=p;return l};const W=l=>(V("data-v-5db641f0"),l=l(),J(),l),X={class:"folder-line"},Y=h("\u9009\u62E9\u6587\u4EF6\u5939"),ee={class:"folder-path"},te=h("\xA0\xA0"),se=[te],oe=h(" \u91CD\u65B0\u540C\u6B65 "),ae=W(()=>u("span",null,"\xA0\xA0",-1)),ne={class:"pagination-line"},le={class:"pic-box"},re=["src","onClick"],ie=["title"],ce={class:"pagination-line"},ue=S({setup(l){console.log(window.electron);const n=g(!1),r=g(D("SELECTED_PATH")||""),p=g([]),o=g(0),s=g(1),c=g(D("PAGE_SIZE")||K),w=g([]),P=(e,t)=>`${r.value}/${e}/${t}`,T=e=>window.electron.getImg(P(e.project_folder,e.preview)),$=async e=>{for(const[t,a]of e.entries()){const d=await T(a);w.value.splice(t,1,d)}},j=e=>{window.electron.apis.openFile(P(e.project_folder,e.file))},y=async(e,t,a)=>{!e||window.electron.apis.getProjectsByPage(e,t,a).then(d=>{console.log("getProjects res",d);const v=d.data.list;p.value=v,o.value=d.data.total,w.value=new Array(v.length).fill(void 0),$(v)})},F=async e=>{n.value=!0;const t=new Promise(d=>setTimeout(d,500)),a=await window.electron.apis.scanProjectsToDb(e);t.then(()=>{n.value=!1,console.log("scanRes",a),a.success?(b({showClose:!0,message:`\u6210\u529F\u540C\u6B65 ${a.data.length} \uFF0C\u65B0\u589E ${a.data.newCount} \uFF0C\u6E05\u9664 ${a.data.invalidCount} \u3002`,type:"success",duration:2500}),s.value===1&&y(r.value,1,c.value),s.value=1):(console.log(a.msg),b({showClose:!0,message:`\u53D1\u751F\u4E86\u9519\u8BEF\uFF1A ${a.msg}`,type:"error",duration:2500}))})},N=async()=>{const e=await window.electron.apis.selectFolder();e.success&&e.data&&(r.value=e.data,z("SELECTED_PATH",e.data),F(e.data))};return O([s,c],([e,t],[,a])=>{if(t!==a&&(z("PAGE_SIZE",t),e!==1)){s.value=1;return}y(r.value,e,t)}),y(r.value,s.value,c.value),(e,t)=>{const a=U,d=H,v=Z;return f(),_(E,null,[u("div",X,[m(a,{onClick:N},{default:A(()=>[Y]),_:1}),u("div",ee,[u("span",null,I(r.value),1),x(u("span",null,se,512),[[v,n.value]])]),x(m(a,{onClick:t[0]||(t[0]=()=>F(r.value))},{default:A(()=>[oe]),_:1},512),[[G,r.value]]),ae]),u("div",ne,[m(d,{currentPage:s.value,"onUpdate:currentPage":t[1]||(t[1]=i=>s.value=i),"page-size":c.value,"onUpdate:page-size":t[2]||(t[2]=i=>c.value=i),"page-sizes":L(B),total:o.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])]),u("div",le,[(f(!0),_(E,null,k(p.value,(i,C)=>(f(),_("div",{key:C,class:"pic-item"},[u("img",{class:"img",alt:"",src:w.value[C],onClick:ge=>j(i)},null,8,re),u("p",{title:i.title},I(i.title),9,ie)]))),128)),(f(),_(E,null,k(10,i=>u("div",{key:i,class:"pic-item",style:{"margin-top":"0"}})),64))]),u("div",ce,[m(d,{currentPage:s.value,"onUpdate:currentPage":t[3]||(t[3]=i=>s.value=i),"page-size":c.value,"onUpdate:page-size":t[4]||(t[4]=i=>c.value=i),"page-sizes":L(B),total:o.value,background:"",layout:"prev, pager, next, total, sizes"},null,8,["currentPage","page-size","page-sizes","total"])])],64)}}});var de=Q(ue,[["__scopeId","data-v-5db641f0"]]);const pe=S({setup(l){return(n,r)=>(f(),M(de))}});R(pe).mount("#app");
